Got it ‚Äî you don‚Äôt want a ‚Äúdumped solution,‚Äù you want a **guided build** with a structured set of incremental steps you can follow (like a workshop). I‚Äôll lay out the **first 10 steps** that get you from ‚Äúnothing‚Äù to ‚Äúbasic video playback with annotations,‚Äù while keeping things in Vue + TypeScript and making sure you understand the reasoning.

---

### üõ†Ô∏è First 10 Steps Toward Your Annotatable Video App

**Step 1. Initialize the Project**

* Run:

  ```bash
  npm create vite@latest piano-annotator -- --template vue-ts
  cd piano-annotator
  npm install
  npm run dev
  ```
* ‚úîÔ∏è You now have a Vue + TS scaffold running on `http://localhost:5173`.

---

**Step 2. Set Up Git (without video files)**

* Initialize git:

  ```bash
  git init
  echo "node_modules/" >> .gitignore
  echo "videos/" >> .gitignore
  echo "annotations/" >> .gitignore
  ```
* ‚úîÔ∏è Keeps large `.mp4` and `.json` files out of your repo.

---

**Step 3. Project File Structure**
Inside your project, create folders:

```
/videos        <-- where you'll manually place local .mp4 files
/annotations   <-- where you'll save JSON annotation files
/src/components
```

* ‚úîÔ∏è This separates app code from user data.

---

**Step 4. Add a Video Player Component**

* In `/src/components/VideoPlayer.vue`:

  ```vue
  <template>
    <div>
      <video ref="videoRef" controls width="640">
        <source src="/videos/sample.mp4" type="video/mp4" />
      </video>
    </div>
  </template>

  <script setup lang="ts">
  import { ref } from 'vue'
  const videoRef = ref<HTMLVideoElement | null>(null)
  </script>
  ```
* ‚úîÔ∏è First video plays locally (drag a `sample.mp4` into `/public/videos/` for now).

---

**Step 5. Add Playback Speed Controls**
Extend the player with simple buttons:

```vue
<button @click="setSpeed(0.5)">0.5x</button>
<button @click="setSpeed(0.75)">0.75x</button>
<button @click="setSpeed(1)">1x</button>

<script setup lang="ts">
function setSpeed(rate: number) {
  if (videoRef.value) videoRef.value.playbackRate = rate
}
</script>
```

* ‚úîÔ∏è Lets you slow down playback.

---

**Step 6. Frame-by-Frame Controls**

* Add keyboard listeners to `VideoPlayer.vue`:

  ```ts
  import { onMounted, onUnmounted } from 'vue'

  function stepFrame(forward = true) {
    if (!videoRef.value) return
    const fps = 30 // assume 30fps, refine later
    videoRef.value.currentTime += (forward ? 1 : -1) / fps
  }

  function handleKey(e: KeyboardEvent) {
    if (e.key === ',') stepFrame(false)
    if (e.key === '.') stepFrame(true)
  }

  onMounted(() => window.addEventListener('keydown', handleKey))
  onUnmounted(() => window.removeEventListener('keydown', handleKey))
  ```
* ‚úîÔ∏è Mimics YouTube‚Äôs `,` and `.` frame-step behavior.

---

**Step 7. Basic Annotation Model**
Create `/src/types/Annotation.ts`:

```ts
export interface Annotation {
  time: number
  hand: 'L' | 'R'
  finger: number
  note: string
}
```

* ‚úîÔ∏è This matches your JSON idea.

---

**Step 8. Add Annotation Capture**
In `VideoPlayer.vue`:

```vue
<button @click="addAnnotation">Add Annotation</button>

<ul>
  <li v-for="(a, i) in annotations" :key="i">
    {{ a.time.toFixed(2) }}s - {{ a.hand }}{{ a.finger }} on {{ a.note }}
  </li>
</ul>

<script setup lang="ts">
import { ref } from 'vue'
import type { Annotation } from '../types/Annotation'

const annotations = ref<Annotation[]>([])

function addAnnotation() {
  if (!videoRef.value) return
  annotations.value.push({
    time: videoRef.value.currentTime,
    hand: 'L',
    finger: 3,
    note: 'A3'
  })
}
</script>
```

* ‚úîÔ∏è You can now capture annotations at paused moments.

---

**Step 9. Display Annotations on Playback**

* Use `timeupdate` event:

  ```ts
  function checkAnnotations() {
    if (!videoRef.value) return
    const t = videoRef.value.currentTime
    annotations.value.forEach(a => {
      if (Math.abs(a.time - t) < 0.1) {
        console.log('Play annotation:', a)
      }
    })
  }
  onMounted(() => videoRef.value?.addEventListener('timeupdate', checkAnnotations))
  ```
* ‚úîÔ∏è When video passes an annotated time, the event fires (for now, just logs).

---

**Step 10. Persist Annotations to JSON**

* Create `AnnotationStore.ts` in `/src/utils`:

  ```ts
  import type { Annotation } from '../types/Annotation'

  export function saveAnnotations(file: string, annotations: Annotation[]) {
    localStorage.setItem(file, JSON.stringify(annotations))
  }

  export function loadAnnotations(file: string): Annotation[] {
    const data = localStorage.getItem(file)
    return data ? JSON.parse(data) : []
  }
  ```
* ‚úîÔ∏è Simple persistence without a backend. Later you can export/import `.json`.

---

‚úÖ At this point, you have:

* A Vue + TS app scaffold
* Local video playback (with speed + frame stepping)
* Ability to add and view annotations
* Annotations linked to time in playback
* Storage in `localStorage` (later exportable to `.json`)

---

Would you like me to **extend the roadmap** (steps 11‚Äì20) toward your ‚Äúannotation goals‚Äù idea (looping sections, marking done, JSON export/import, MIDI playback), or should we first go deeper into **refining the frame accuracy + UI design** for steps 1‚Äì10?
